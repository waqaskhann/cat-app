{"ast":null,"code":"import _toConsumableArray from\"/Users/waqaskhan/Sites/cat-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/Users/waqaskhan/Sites/cat-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/waqaskhan/Sites/cat-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/waqaskhan/Sites/cat-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from'react';import{Link}from'react-router-dom';import axios from'axios';import{AppContext}from'../App';import'./Homepage.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Homepage=function Homepage(){var _useContext=useContext(AppContext),breed=_useContext.breed,setBreed=_useContext.setBreed;var _useContext2=useContext(AppContext),lastVisitedWasSingle=_useContext2.lastVisitedWasSingle,setLastVisitedWasSingle=_useContext2.setLastVisitedWasSingle;var _useContext3=useContext(AppContext),cats=_useContext3.cats,setCats=_useContext3.setCats;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),breeds=_useState2[0],setBreeds=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),loadedCats=_useState8[0],setLoadedCats=_useState8[1];useEffect(function(){// Fetch all available breeds to populate select\nvar fetchBreeds=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('https://api.thecatapi.com/v1/breeds');case 3:response=_context.sent;setBreeds(response.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchBreeds(){return _ref.apply(this,arguments);};}();fetchBreeds();setLastVisitedWasSingle(false);},[]);useEffect(function(){// Fetch cats based on breed and page number\nvar fetchCats=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,newCats;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setIsLoading(true);_context2.prev=1;_context2.next=4;return axios.get(\"https://api.thecatapi.com/v1/images/search?breed_id=\".concat(breed,\"&limit=10&page=\").concat(page));case 4:response=_context2.sent;newCats=response.data.filter(function(cat){return!cats.some(function(existingCat){return existingCat.id===cat.id;});});// Filter out duplicates\nsetCats(function(prevCats){return[].concat(_toConsumableArray(prevCats),_toConsumableArray(newCats));});setLoadedCats(function(prevLoadedCats){return prevLoadedCats+newCats.length;});setIsLoading(false);_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);alert(\"Apologies but we could not load new cats for you at this time! Miau!\");setIsLoading(false);case 15:case\"end\":return _context2.stop();}},_callee2,null,[[1,11]]);}));return function fetchCats(){return _ref2.apply(this,arguments);};}();// Only fetch cats if breed is selected\nif(breed){fetchCats();}else if(breed&&lastVisitedWasSingle){}else{setCats([]);setPage(1);setLoadedCats(0);}},[breed,page]);var renderCats=function renderCats(){if(!breed){return/*#__PURE__*/_jsx(\"div\",{children:\"Please select a breed.\"});}if(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading cats...\"});}if(cats.length===0){return/*#__PURE__*/_jsx(\"div\",{children:\"No cats found for the selected breed.\"});}return cats.map(function(cat){return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"card__img-wrapper\",children:/*#__PURE__*/_jsx(\"img\",{src:cat.url,alt:\"Cat \".concat(cat.id),className:\"card__img\"})}),/*#__PURE__*/_jsx(Link,{to:\"/cat-app/\".concat(cat.id),className:\"card__cta\",children:\"View details\"})]},cat.id);});};var loadMoreCats=function loadMoreCats(){setPage(function(prevPage){return prevPage+1;});};var allCatsLoaded=loadedCats<page*10;var handleBreedChange=function handleBreedChange(e){setBreed(e.target.value);setCats([]);setPage(1);setLoadedCats(0);};return/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Cat browser\"}),/*#__PURE__*/_jsxs(\"select\",{value:breed,onChange:handleBreedChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Breed\"}),breeds.map(function(breed){return/*#__PURE__*/_jsx(\"option\",{value:breed.id,children:breed.name},breed.id);})]}),/*#__PURE__*/_jsx(\"div\",{className:\"cards\",children:renderCats()}),!allCatsLoaded&&/*#__PURE__*/_jsx(\"button\",{onClick:loadMoreCats,disabled:isLoading,children:isLoading?'Loading...':'Load More'})]});};export default Homepage;","map":{"version":3,"names":["React","useContext","useEffect","useState","Link","axios","AppContext","jsx","_jsx","jsxs","_jsxs","Homepage","_useContext","breed","setBreed","_useContext2","lastVisitedWasSingle","setLastVisitedWasSingle","_useContext3","cats","setCats","_useState","_useState2","_slicedToArray","breeds","setBreeds","_useState3","_useState4","page","setPage","_useState5","_useState6","isLoading","setIsLoading","_useState7","_useState8","loadedCats","setLoadedCats","fetchBreeds","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","sent","data","t0","console","error","stop","apply","arguments","fetchCats","_ref2","_callee2","newCats","_callee2$","_context2","concat","filter","cat","some","existingCat","id","prevCats","_toConsumableArray","prevLoadedCats","length","alert","renderCats","children","map","className","src","url","alt","to","loadMoreCats","prevPage","allCatsLoaded","handleBreedChange","e","target","value","onChange","name","onClick","disabled"],"sources":["/Users/waqaskhan/Sites/cat-app/src/pages/Homepage.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { AppContext } from '../App';\nimport './Homepage.scss';\n\nconst Homepage = () => {\n  const { breed, setBreed } = useContext(AppContext);\n  const { lastVisitedWasSingle, setLastVisitedWasSingle } = useContext(AppContext);\n  const { cats, setCats } = useContext(AppContext);\n  const [breeds, setBreeds] = useState([]);\n  const [page, setPage] = useState(1);\n  const [isLoading, setIsLoading] = useState(true);\n  const [loadedCats, setLoadedCats] = useState(0);\n\n  useEffect(() => {\n    // Fetch all available breeds to populate select\n    const fetchBreeds = async () => {\n      try {\n        const response = await axios.get('https://api.thecatapi.com/v1/breeds');\n        setBreeds(response.data);\n      } catch (error) {\n        console.error(error);\n      }\n    };\n\n    fetchBreeds();\n    setLastVisitedWasSingle(false)\n  }, []);\n\n\n  useEffect(() => {\n    // Fetch cats based on breed and page number\n    const fetchCats = async () => {\n      setIsLoading(true);\n\n      try {\n        const response = await axios.get(`https://api.thecatapi.com/v1/images/search?breed_id=${breed}&limit=10&page=${page}`);\n        const newCats = response.data.filter(cat => !cats.some(existingCat => existingCat.id === cat.id)); // Filter out duplicates\n        setCats(prevCats => [...prevCats, ...newCats]);\n        setLoadedCats(prevLoadedCats => prevLoadedCats + newCats.length);\n        setIsLoading(false);\n      } catch (error) {\n        alert(\"Apologies but we could not load new cats for you at this time! Miau!\")        \n        setIsLoading(false);\n      }\n    };\n\n    // Only fetch cats if breed is selected\n    if(breed) {\n      fetchCats();\n    } else if (breed && lastVisitedWasSingle) {\n\n    } else {\n      setCats([]);\n      setPage(1);\n      setLoadedCats(0);\n    }\n    }, [breed,page]);\n\n  const renderCats = () => {\n    if (!breed) {\n      return <div>Please select a breed.</div>;\n    }\n\n    if (isLoading) {\n      return <div>Loading cats...</div>;\n    }\n\n    if (cats.length === 0) {\n      return <div>No cats found for the selected breed.</div>;\n    }\n\n    return cats.map(cat => (\n      <div key={cat.id} className=\"card\">\n        <figure className=\"card__img-wrapper\">\n          <img src={cat.url} alt={`Cat ${cat.id}`} className=\"card__img\"/>\n        </figure>\n        <Link to={`/cat-app/${cat.id}`} className=\"card__cta\">View details</Link>\n      </div>\n    ));\n  };\n\n  const loadMoreCats = () => {\n    setPage(prevPage => prevPage + 1);\n  };\n\n  const allCatsLoaded = loadedCats < page * 10;\n\n  const handleBreedChange = (e) => {\n    setBreed(e.target.value);\n    setCats([]);\n    setPage(1);\n    setLoadedCats(0);\n  };\n\n  return (\n    <div className=\"content-wrapper\">\n      <h1>Cat browser</h1>\n      <select value={breed} onChange={handleBreedChange}>\n        <option value=\"\">Select Breed</option>\n        {breeds.map(breed => (\n          <option key={breed.id} value={breed.id}>{breed.name}</option>\n        ))}\n      </select>\n      <div className=\"cards\">\n        {renderCats()}\n      </div>\n      {!allCatsLoaded &&\n        <button onClick={loadMoreCats} disabled={isLoading}>\n          {isLoading ? 'Loading...' : 'Load More'}\n        </button>\n      }\n    </div>\n  );\n};\n\nexport default Homepage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}